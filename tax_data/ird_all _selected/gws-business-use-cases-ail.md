IN CONFIDENCE Investment Income Information Approved Issuer Levy (AIL) Gateway Services Business use cases Date: Dec 2018 Version: v0.02 IN REVIEW Page 2 IN CONFIDENCE Contents Investment income information – Approved Issuer Levy withholding tax (AIL) use cases 3 How to use this document ................................................................................. 3 Summary of approved issuer levy withholding tax use cases ................................. 3 Use Case 01: File a single AIL return for a month period (Single filer) ................... 4 Use Case 02: File multiple AIL returns for a month period (Multi-filer) .................. 8 Use Case 03: Amend AIL return for a specific period (Single filer) ...................... 13 Use Case 04: Amend AIL return line items for a specific period (Multi-filer) ......... 17 Use Case 05: Replace all data in an AIL return (Reverse Replace) ...................... 21 Use Case 06: Intermediary files an AIL return on behalf of a payer (Single filer) .. 24 Use Case 07: AIL return reassessment – retrieve return (Single filer) ................. 28 Use Case 08: AIL return reassessment – retrieve return (Multi-filer) ................... 31 Page 3 IN CONFIDENCE Investment income information – Approved Issuer Levy withholding tax (AIL) use cases A selection of approved issuer levy withholding tax (AIL) use cases relevant to investment income information (III) business outcomes are provided on this document. How to use this document The approved issuer levy withholding tax business use cases show sequences of IR’s gateway Return service operations that could be used to achieve a specific business outcome. They do not comprise a comprehensive list of all required business outcomes, nor are they prescriptive or intended to inhibit software innovation in any way. Additionally the processes described to invoke the Return service operations should not inhibit innovation to combine calls across the Gateway Service to achieve the same outcome or solve business needs not described here. Summary of approved issuer levy withholding tax use cases # Business use case File Retrieve Status Retrieve Return 1 File a single AIL return for a month period and optionally retrieve return status 1 2\* 2 File multiple AIL returns for a month period and optionally retrieve return status 1 2\* 3 Amend one or more line items in an AIL return as a single filer 1 4 Amend one or more line items in an AIL return as a multi filer. 1 5 Replace all data in an AIL return (Reverse Replace) - optionally retrieve AIL return status for a specified period, file an amended single AIL return the same period for all transactions. 1 6 Intermediary files an AIL return on behalf of a payer for a specific period and optionally retrieve return status 1 2\* 7 Retrieve AIL return as a single filer for the specific period. 1 8 Retrieve AIL return as a multi filer for a specific period. 1\* 2 Note - “\*” indicates optional process steps. Page 4 IN CONFIDENCE Use Case 01: File a single AIL return for a month period (Single filer) File a single AIL return for a month period IR Gateway Services Payer Payer Software myIR Services Period after deductions made Optionally Optionally on the next day 1. Confirm AIL transactions are ready to be filed 2. File AIL return 3. Invoke File operation 4. Process AIL return, allocate submission key and confirm response code 6. Request AIL return status 7. Submit AIL return status request 5. Receive AIL return submission key and response code 10. Receive AIL return status and submission key and response code 9. Get data 11. View AIL return status 12. Access AIL account In myIR 13. View AIL account balance for period End Start 8. Invoke retrieveStatus operation Page 5 IN CONFIDENCE Use Case 01 details - File a single AIL return for a month period Primary actor Payer Secondary actors Payer software Returns service Description • Payer files a single AIL return for a month period for all investors including single and joint account holders. • Optionally on the next day, the payer retrieves return status of the previous month’s AIL return to confirm if it has been processed. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer has a logon for myIR. • Payer is enrolled for AIL account as a single filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer software collates transactions for all investors of the month period after the month end date. Post-conditions • Payer’s request is accepted and responded to • IR processes the filed AIL return and o posts the submitted investors account holder details on their income tax account in myIR on the next day. o posts the summary return totals for the previous month on the Payers AIL account in myIR on the next day. • Optionally, the payer accesses the payer’s AIL account in myIR and reconciles the account debit due. • Payer makes payment by due date to IR for the payer AIL account. Constraints • The request must be sent using the Payer software. • To file a valid AIL return, details must be provided for: o the payer’s ird number, o the account type stated as AIL, o the filing period end date, o each account holders name, and at least one contact detail of email, phone or postal address, o at least one set of income information per line item. Use case scenarios 1. Normal flow 1.1 Payer confirms the AIL return for the period is ready to be filed. 1.2 Payer software files a single AIL return for a month period. 1.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 1.4 Payer software receives the response code and the unique submission key for the AIL return. Optional process to confirm the payer AIL return status, on the next day 1.5 Payer initiates a status request of the AIL return for the specified period. 1.6 Payer software requests the status of the previously filed AIL return using either the period end date or the submission key allocated to that AIL return. 1.7 Returns service ‘RetrieveStatus’ operation is invoked. Page 6 IN CONFIDENCE 1.8 Returns service responds with a response code of “0” (success), the status of the previously filed AIL return and the original submission key. 1.9 Payer software receives the response code and the original submission key for the AIL return. 1.10 Payer views the status of the AIL return. 1.11 Use case ends. 2. Alternative flow – file using gateway to file, then using myIR to view status and debit owed on Payer AIL account 2.1 Payer confirms the AIL return for the period is ready to be filed. 2.2 Payer software files a single AIL return for a month period. 2.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 2.4 Payer software receives the response code and the unique submission key for the AIL return. Optional process to confirm the payer AIL return status. 2.5 Payer accesses AIL account in myIR 2.6 Payer views status of the AIL return to confirm if it has been processed. 2.7 If processed, payer is able to view the total posted AIL account debit due for payment. 2.8 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Payer confirms the AIL return for the period is ready to be filed. 3.2 Payer software files the single AIL return for a month period. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November or account holder line items are missing for at least one contact detail. 3.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 3.6 Payer software receives the error response code for the AIL return. 3.7 Payer reviews the error message and makes amendments to the payload format or data then confirms the Payer AIL return is ready to be filed. Note: Even if one or more line items are in error the complete return containing all line items needs to be filed. 3.8 Payer software files a single AIL return for a month period. 3.9 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and a unique submission key. 3.10 Payer software receives the response code and the unique submission key for the AIL return 3.11 Use case ends. Page 7 IN CONFIDENCE 4. Exception Flow – Payer is not registered for service 4.1 Payer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Payer is not Authorised to use Service 5.1 The payer is valid, however doesn’t have the correct permissions to use this service. 5.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Payer software displays the error message 5.4 Payer views the error message 5.5 Use case ends. 6. Exception – Authentication token is expired 6.1 Identity and access services validates and finds the authentication token has expired. 6.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 6.3 Identity and access services validate credentials and generates a new token. 6.4 Identity and access services records a new token generation request. 6.5 Use case ends. Page 8 IN CONFIDENCE Use Case 02: File multiple AIL returns for a month period (Multi-filer) File multiple AIL returns for a month period IR Gateway Services Payer Payer Software myIR Services Month after deductionsMonth with deductions Optionally 1. Confirm AIL transactions are ready to be filed 2. File AIL return 3. Invoke File operation 4. Process AIL return, allocate submission key and confirm response code 6. Request AIL return status for all submitted returns 7. Submit AIL returns status request by period end date 8. Invoke retrieveStatus operation 5. Receive AIL return submission key and response code 10. Receive AIL return status and submission key and response code 9. Get data 11. View AIL return status for all submitted returns 12. Access AIL account In myIR 13. View AIL account balance for period End Start Reoccurrng Optionally On or after 20 th of month Page 9 IN CONFIDENCE Use Case 02 details - File multiple AIL returns for a month period (multi-filer) Primary actor Payer Secondary actors Payer software Returns service Description • Payer files multiple AIL returns for a month period for all investors including single and joint account holders. Example: o AIL Return 1 has line items 1-100,000, o AIL Return 2 has line items 100,001-200,000 and o AIL Return 3 has line items 200,001-250,00 • As a registered multi-filer the payer can file the multiple AIL returns at any time during the month period and up to the 20 th of the month following e.g. they can be filled o at the same time as the AIL withholding tax is deducted on investors account o as a combined filing of all the returns at a point in time. • Optionally, the payer retrieves the return status of the previous month’s AIL return to confirm to confirm if it has been processed. Note: for a multi-filer the return will only be processed on the 20th of the month following the period end date. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer has a logon for myIR. • Payer is enrolled for AIL account as a multi-filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. Post-conditions • Payer’s request is accepted and responded to. • IR processes the filed AIL return and posts the submitted investors AIL details on their income tax account in myIR on the next day. • On the 20 th of the month following IR processes and posts single summary return totals for the previous month on the Payers AIL account in myIR on the next day. • Optionally on or after the 20 th of the month following the payer accesses the payer’s AIL account in myIR and reconciles the account debit due. • Payer makes payment to IR for the payer AIL account. Constraints • The request must be sent using the Payer software. • To file a valid AIL return, details must be provided for: o the payer’s ird number, o the account type stated as AIL, o the filing period end date, o each account holders name, and at least one contact detail of email, phone or postal address, o at least one set of income information per line item. Use case scenarios 1. Normal flow At a filing pattern determined by the payer after withholding deductions on interest accounts has been made. 1.1 Payer confirms a AIL return for the period is ready to be filed. Page 10 IN CONFIDENCE 1.2 Payer software files an AIL return for a defined period for all investor accounts that have had withholding tax on interest deducted. 1.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 1.4 Payer software receives the response code and the unique submission key for the AIL return. This filing pattern is repeated for multiple AIL returns within the month period. Optional process to confirm the payer AIL return status 1.5 Payer initiates a status request of the AIL returns for the specified period end date. 1.6 Payer software requests the status of the previously filed AIL return using either • the period end date to retrieve the status of all returns • or the unique submission key to retrieve the status of a single AIL return. 1.7 Returns service ‘RetrieveStatus’ operation is invoked. 1.8 Returns service responds with a response code of “0” (success), the status of the previously filed AIL return and the original submission key. 1.9 Payer software receives the status of each requested AIL return. 1.10 Use case ends. 2. Alternative flow – file using gateway to file, then using myIR to view status and debit owed on Payer AIL account At a filing pattern determined by the payer after withholding deductions on interest accounts has been made. 2.1 Payer confirms a AIL return for the period is ready to be filed. 2.2 Payer software files an AIL return for a defined period for all investor accounts that have had withholding tax on interest deducted. 2.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 2.4 Payer software receives the response code and the unique submission key for the AIL return. This filing pattern is repeated for multiple AIL returns within the month period. Optional processes, normally on the 20 th of the month following 2.5 Payer accesses AIL account in myIR 2.6 Payer views status of all filed AIL returns to confirm if they have been processed. 2.7 If all have processed, payer is able to view the total posted AIL account debit due for payment. 2.8 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Payer confirms a AIL return for the period is ready to be filed. 3.2 Payer software files an AIL return for a month period. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including Page 11 IN CONFIDENCE • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November or account holder line items are missing at least one contact detail. 3.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 3.6 Payer software receives the error response code for the AIL return. 3.7 Payer reviews the error message and makes amendments to the payload format or data then confirms the Payer AIL return is ready to be filed. Note: Even if one or more line items are in error the complete return containing all line items needs to be filed. 3.8 Payer software files the AIL return for a month period. 3.9 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 3.10 Payer software receives the response code and a unique submission key for the AIL return. 3.11 Use case ends. 4. Exception Flow – Payer is not registered for service 4.1 Payer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Payer is not Authorised to use Service 5.1 The payer is valid, however doesn’t have the correct permissions to use this service. 5.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Payer software displays the error message 5.4 Payer views the error message 5.5 Use case ends. 6. Exception – Authentication token is expired 6.1 Identity and access services validates and finds the authentication token has expired. 6.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 6.3 Identity and access services validate credentials and generates a new token. 6.4 Identity and access services records a new token generation request. Page 12 IN CONFIDENCE 6.5 Use case ends. Page 13 IN CONFIDENCE Use Case 03: Amend AIL return for a specific period (Single filer) Amend line items for a AIL return (Single filer) IR Gateway Services Payer Payer Software Period during deductions or after deductions made 4. Process AIL return, provide original submission key and confirm response code 5. Receive AIL return submission key and response code 1. Confirm amended AIL transactions are ready to be filed 2. File AIL amendment return with updated line items only 3. Invoke File operation Sta rt End Page 14 IN CONFIDENCE Use Case 03 details - Amend AIL return line items for a specific period (Single filer) Primary actor Payer Secondary actors Payer software Returns service Description • Payer determines an amendment is required to one or more line items in the previously filed AIL return for a specific period. • Payer files an amended AIL return for the same period which includes only the updated line items. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer has a logon for myIR. • Payer is enrolled for an AIL account as a single or multi filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer has filed an AIL return for a previous period for all investors including single and joint account holders Post-conditions • Payer’s request is accepted and responded to. • IR processes the filed AIL return and o posts the submitted investors account holder details on their income tax account in myIR on the next day. o posts the summary return totals for the previous month on the Payers AIL account in myIR on the next day. • Optionally, the payer accesses the payer’s AIL account in myIR and reconciles the account debit due. • Payer makes payment by due date to IR for the payer AIL account. Constraints • The request must be sent using the Payer software. • As the payer is registered as a single filer in order to file amendments they can either provide: o the payer’s ird number, the account type stated as AIL and the period end-date or o the submission key from a previously filed AIL return. • Additionally, to file a valid AIL return amendment, details must be provided for: o “isAmended” to confirm this is an amended return plus optionally the amend reason (KEY / MATH / OTHER / TRNSPO) and amend details, o for each updated line item ▪ the reference ID they have previously assigned to the line item or ▪ if no assigned reference ID they must supply the line item ID assigned to the processed return by IR. o To retrieve the line item ID they will need to invoke the “retrieveReturn” operation – refer to Use Case 07 for process steps. Use case scenarios 1. Normal flow Amendment is ready to be filed for an AIL return 1.1 Payer confirms the Payer AIL return amended line items are ready to be filed. Page 15 IN CONFIDENCE 1.2 Payer software files an amended AIL return for a specific period with the updated line items. 1.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the original return submission key. 1.4 Payer software receives the response code and the original return submission key for the amended AIL return. 1.5 Use case ends. 2. Exception Flow – Submission Key unknown for the AIL return Optionally to confirm return status and or submission key 2.1 Payer initiates a status request of the previously submitted AIL return for a specified period end date. 2.2 Payer software requests the status of the previously filed AIL return using the payer name and period end date. 2.3 Returns service ‘RetrieveStatus’ operation is invoked. 2.4 Returns service responds with the status of the previously filed AIL return and the submission key. Amendment is ready to be filed for an AIL return 2.5 Payer confirms the Payer AIL return amended line items are ready to be filed. 2.6 Payer software files an amended AIL return for a specific period. 2.7 Returns service ‘File’ operation is invoked and responds with a status code of “0” (success) and the original return submission key. 2.8 Payer software receives the response code and the original return submission key for the amended AIL return. 2.9 Use case ends. 3. Exception Flow – Line item ids required to submit amendments 3.1 Payer initiates a retrieve return request of the previously submitted AIL return for a specified period end date. 3.2 Payer software requests the status of the previously filed AIL return using the payer name and period date. 3.3 Returns service ‘RetrieveStatus’ operation is invoked. 3.4 Returns service responds with a response code of “0” (success), the status of the previously filed AIL return and the original submission key. Amendment is ready to be filed for an AIL return 3.5 Payer confirms the Payer AIL return amended line items are ready to be filed. 3.6 Payer software files an amended AIL return for a specific period. 3.7 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the original return submission key. 3.8 Payer software receives the response code and the original return submission key for the amended AIL return. 3.9 Use case ends. 4. Exception Flow – message fails schema or other validation 4.1 Payer confirms the Payer AIL return amended line items are ready to be filed. 4.2 Payer software files an amended AIL return for a specific period. 4.3 Returns service ‘File’ operation is invoked. Page 16 IN CONFIDENCE 4.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November 4.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 4.6 Use case ends. 5. Exception Flow – Payer is not registered for service 5.1 Payer is not registered for the ‘Returns’ service. 5.2 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 5.3 Use case ends. 6. Exception – Payer is not Authorised to use Service 6.1 The payer is valid, however doesn’t have the correct permissions to use this service. 6.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 6.3 Payer software displays the error message 6.4 Payer views the error message 6.5 Use case ends. 7. Exception – Authentication token is expired 7.1 Identity and access services validates and finds the authentication token has expired. 7.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 7.3 Identity and access services validate credentials and generates a new token. 7.4 Identity and access services records a new token generation request. 7.5 Use case ends. Page 17 IN CONFIDENCE Use Case 04: Amend AIL return line items for a specific period (Multi- filer) Amend line items for a AIL return (Multi-filer) IR Gateway Services Payer Payer Software Period during deductions or after deductions made 4. Process AIL return, provide original submission key and confirm response code 5. Receive AIL return submission key and response code 1. Confirm amended AIL transactions are ready to be filed 2. File AIL amendment return with original submission key for updated line items only 3. Invoke File operation Sta rt End Page 18 IN CONFIDENCE Use Case 04 details - Amend AIL return line items for a specific period (Multi-filer) Primary actor Payer Secondary actors Payer software Returns service Description • Payer determines an amendment is required to one or more line items in the previously filed AIL return for a specific period. Payer files an amended AIL return for the same period which includes only the updated line items. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer has a logon for myIR. • Payer is enrolled for an AIL account as a single or multi filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer has filed an AIL return for a previous period for all investors including single and joint account holders Post-conditions • Payer’s request is accepted and responded to. • IR processes each filed AIL return and posts the updated investors AIL details on their income tax account in myIR • On the 20 th of the month following IR processes and posts the summary return totals from all AIL returns for the previous month on the Payers AIL account in myIR. • Optionally on or after the 20 th of the month following the payer accesses the payer’s AIL account in myIR and reconciles the account debit due. • Payer makes payment by due date to IR for the payer AIL account. Constraints • The request must be sent using the Payer software. • As the payer is registered as a multi-filer they must provide a submission key from a previously filed AIL return in order to file amendments for an AIL return. • To file a valid AIL return amendment, details must be provided for: o “isAmended” to confirm this is an amended return plus optionally the amend reason (KEY / MATH / OTHER / TRNSPO) and amend details, o For each updated line item ▪ the reference ID they have previously assigned to the line item or ▪ if no assigned reference ID they must supply the line item ID assigned to the processed return by IR. o To retrieve the line item ID the payer will need to invoke the “retrieveReturn” operation – refer to Use Case 07 for process steps. Use case scenarios 1. Normal flow Amendment is ready to be filed for an AIL return 1.1 Payer confirms the Payer AIL return amended line items are ready to be filed. 1.2 Payer software files an amended AIL return for a specific period with the updated line items. Page 19 IN CONFIDENCE 1.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the original AIL return submission key. 1.4 Payer software receives the response code and the original return submission key for the amended AIL return. 1.5 Use case ends. 2. Exception Flow – Submission Key unknown for the AIL return To confirm submission key of a filed AIL return 2.1 Payer initiates a single status request of all filed AIL return for the specified period. 2.2 Payer software requests the return status the previously filed AIL returns using the payer name and period end date. 2.3 Returns service ‘RetrieveStatus’ operation is invoked. 2.4 Returns service responds with a response code of “0” (success), the status of all previously filed AIL return and their submission keys. Amendment is ready to be filed for an AIL return 2.5 Payer confirms the Payer AIL return amended line items are ready to be filed. 2.6 Payer software files an amended AIL return for a specific period. 2.7 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the original return submission key. 2.8 Payer software receives the response code and the original return submission key for the amended AIL return. 2.9 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Payer confirms the Payer AIL return amended line items are ready to be filed. 3.2 Payer software files an amended AIL return for a specific period. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations 3.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 3.6 Use case ends. 4. Exception Flow – Payer is not registered for service 4.1 Payer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Payer is not 5.1 The payer is valid, however doesn’t have the correct permissions to use this service. Page 20 IN CONFIDENCE Authorised to use Service 5.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Payer software displays the error message 5.4 Payer views the error message 5.5 Use case ends. 6. Exception – Authentication token is expired 6.1 Identity and access services validate and find authentication token expired 6.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the ‘Identity and Access Services’ build pack) 6.3 Identity and access services validate credentials and generate new token. 6.4 Identity and access services records new token generation request 6.5 Use case ends. Page 21 IN CONFIDENCE Use Case 05: Replace all data in an AIL return (Reverse Replace) Replace all data in an AIL return (Reverse Replace) IR Gateway Services Payer Payer Software Period during deductions or after deductions made 5. Process AIL return, allocate Submission Key and confirm response code 6. Receive AIL return Submission Key and response code 1. Make amendments to all line items in the AIL return 2. Confirm amended AIL transactions are ready to be filed 3. File AIL amendment return (Reverse Replace) 4. Invoke File operation Start End Page 22 IN CONFIDENCE Use Case 05 details - Replace all data in an AIL return (Reverse Replace) Primary actor Payer Secondary actors Payer software Returns service Description • Payer determines an amendment is required to all line items in the previously filed AIL return for a specific period • Payer files an update of a previously filed AIL return with includes a complete set of updated line items for the same period. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer has a logon for myIR. • Payer is enrolled for an AIL account as a single or multi filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer has filed a AIL return for a previous period for all investors including single and joint account holders. Post-conditions • Payer’s request is accepted and responded to. • IR processes the filed AIL return and posts summary return totals for the previous month on the Payer’s AIL account in myIR. • Payer accesses the payer’s AIL account in myIR and reconciles the account debit due. • Payer makes payment by due date to IR for the payer AIL account. Constraints • The request must be sent using the Payer software. • If the payer is registered as a single filer they can either provide: o the payer’s ird number, the account type stated as AIL and the period end-date or o the submission key from a previously filed AIL return. • If the payer is registered as a multi-filer they must provide a submission key from a previously filed AIL return in order to file amendments. Use case scenarios 1. Normal flow 1.1 Payer makes amendments to all line items in the previously filed AIL return for a specific period. 1.2 Payer confirms all line items of a previous Payer AIL return are ready to be filed. 1.3 Payer software files an amended AIL return for a month period. This contains • “isAmended” to confirm this is an amended return plus optionally the amend reason (KEY / MATH / OTHER / TRNSPO) and amend details • “isReverseReplace” to confirm this is a full resubmission of a previous return • updated lines items 1.4 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 1.5 Payer software receives the response code and the unique submission key for the AIL return. 1.6 Use case ends. Page 23 IN CONFIDENCE 2. Exception Flow – Invalid payload or data 2.1 Payer confirms the complete amended Payer AIL return is ready to be filed. 2.2 Payer software files an amended AIL return for a specific period. 2.3 Returns service ‘File’ operation is invoked. 2.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November or account holder line items are missing for at least one contact detail. 2.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 2.6 Payer software receives the error response code for the AIL return 2.7 Use case ends. 3. Exception Flow – Payer is not registered for service 3.1 Payer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Payer is not Authorised to use Service 4.1 The payer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Payer software displays the error message 4.4 Payer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request 5.5 Use case ends. Page 24 IN CONFIDENCE Use Case 06: Intermediary files an AIL return on behalf of a payer (Single filer) File a single AIL return for a month period as an Intermediary IR Gateway Services Intermediary Intermediary Software myIR Services Period after deductions made 1. Confirm AIL transactions are ready to be filed 2. File Payer AIL return 3. Invoke File operation 4. Process AIL return, allocate Submission Key and confirm response code 6. Request Payer AIL return status 7. Submit Payer AIL return status request 8. Invoke retrieveStatus operation 5. Receive AIL return submission key and response code Optionally on the next day 10. Receive AIL return status and submission key and response code 9. Get data 11. View Payer AIL return status 12. Access myIR AIL account 13. View Payer AIL account balance for period Optionally End Start Page 25 IN CONFIDENCE Use Case 06 details - Intermediary files an AIL return on behalf of a payer (Single filer) Primary actor Intermediary Secondary actors Intermediary software Returns service Payer Description • Intermediary files a single AIL return for a month period for all investors including single and joint account holders. • Optionally on the next day, the intermediary retrieves return status of the previous month’s AIL return to confirm if it has been processed. Pre-conditions • Intermediary is authenticated, authorised to act on behalf of the Payer and logged into intermediary software. • Payer is enrolled for AIL account as a single filer. • Intermediary has a logon for myIR. • Intermediary has an intermediary account link to the clients AIL account • Intermediary has File or Full account access to the AIL account (this is controlled by the client list security settings) • Payer or intermediary pays investors interest on their investment accounts and deducts withholding tax on the interest. • Intermediary collates transactions for all investors of the month period after the month end date. Post-conditions • Intermediary’s request is accepted and responded to • IR processes the filed AIL return and o posts the submitted investors account holder details on their income tax account in myIR on the next day. o posts the summary return totals for the previous month on the Payers AIL account in myIR on the next day. • Optionally o the intermediary accesses the payer’s AIL account in myIR and reconciles the account debit due. o Intermediary makes payment by due date to IR for the payer AIL account. • Alternatively o the intermediary accesses the payer’s AIL account in myIR and reconciles the account debit due. o Intermediary informs the payer to make payment by due date to IR for the payer AIL account. Constraints • The request must be sent using the Intermediary software. • To file a valid AIL return, details must be provided for: o the payer’s ird number, o the account type stated as AIL, o the filing period end date, o each account holders name, and at least one contact detail of email, phone or postal address, o at least one set of income information per line item. Use case scenarios 1. Normal flow 1.1 Intermediary confirms the AIL return for the period is ready to be filed. Page 26 IN CONFIDENCE 1.2 Intermediary software files a single AIL return for a month period. 1.3 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and the unique submission key. 1.4 Intermediary software receives the response code and the unique submission key for the AIL return. Optional process to confirm the payer AIL return status, on the next day 1.5 Intermediary initiates a status request of the AIL return for the specified period. 1.6 Intermediary software requests the status of the previously filed AIL return using either the period end date or the submission key allocated to that AIL return. 1.7 Returns service ‘RetrieveStatus’ operation is invoked. 1.8 Returns service responds with a response code of “0” (success), the status of the previously filed AIL return and the original submission key. 1.9 Intermediary software receives the response code and the unique submission key for the AIL return. 1.10 Intermediary views the status of the AIL return. 1.11 Use case ends. 2. Exception Flow – message fails schema or other validation 2.1 Intermediary confirms the AIL return is ready to be filed 2.2 Intermediary software files a single AIL return for a month period. 2.3 Returns service ‘File’ operation is invoked. 2.4 Returns service processes and invalidates the AIL return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November or account holder line items are missing for at least one contact detail. 2.5 Returns service returns an error response to the Payer software; with one or more error codes, up to a maximum of 200. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 2.6 Intermediary software receives the error response code for the AIL return. 2.7 Intermediary reviews the error message and makes amendments to the payload format or data then confirms the AIL return is ready to be filed. Note: Even if one or more line items are in error the complete return containing all line items needs to be filed. 2.8 Intermediary software files a single AIL return for a month period. 2.9 Returns service ‘File’ operation is invoked and responds with a response code of “0” (success) and a unique submission key. Page 27 IN CONFIDENCE 2.10 Intermediary software receives the response code and the unique submission key for the AIL return 2.11 Use case ends. 3. Exception Flow – Payer is not registered for service 3.1 Intermediary is not registered for the ‘Returns’ service. 3.2 Identity and access services returns an error response to the Intermediary software due to unauthorised access OR unauthorised delegation 3.3 Use case ends. 4. Exception – Payer is not Authorised to use Service 4.1 The intermediary is valid, however doesn’t have the correct permissions to use this service, eg they only have ‘read only’ access rights or a not linked to the correct client list as an intermediary 4.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation OR • Unauthorised vendor OR • Account type not supported 4.3 Intermediary software displays the error message 4.4 Intermediary views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Intermediary software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 28 IN CONFIDENCE Use Case 07: AIL return reassessment – retrieve return (Single filer) Retrieve previous AIL return (Single filer) IR Gateway Services Payer Payer Software Period during deductions or after deductions made 4. Process request, send AIL return payload and confirm response code 5. Receive previous AIL return data a nd response code 1. Retrieve AIL return is initiated 2. Retrieve AIL return is submitted with period end date or submission key 3. Invoke retrieveReturn operation Sta rt End Page 29 IN CONFIDENCE Use Case 07 details - AIL return reassessment – retrieve return (Single filer) Primary actor Payer Secondary actors Payer software Returns service Description • Payer determines a return reassessment is required an amendment is required for a previously filed AIL return for a specific period • Payer submits a retrieve return request to retrieve all line items from a previously file AIL return. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer is enrolled for an AIL account as a single filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer has filed a AIL return for a previous period for all investors including single and joint account holders. Post-conditions • Payer’s request is accepted and responded to. Constraints • The request must be sent using the Payer software. • As a single filer the payer can either provide o the payer’s ird number, the account type stated as AIL and period end date or o the submission key from a previously filed AIL return. Use case scenarios 1. Normal flow 1.1 Payer initiates the request to retrieve a previous AIL return. 1.2 Payer software submits a retrieve AIL return for a specified period. 1.3 Returns service ‘retrieveReturn’ operation is invoked. 1.4 Returns service collates the AIL return data. 1.5 Returns service responds with a response code of “0” (success) and the AIL return data payload for the specified period. 1.6 Payer software receives the response code and the AIL return data payload. 1.7 Use case ends. 2. Exception Flow – message fails schema or other validation 2.1 Payer initiates the request to retrieve a previous AIL return. 2.2 Payer software submits a retrieve AIL return for a specified period. 2.3 Returns service ‘retrieveReturn’ operation is invoked. 2.4 Returns service processes and invalidates the request due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g period end date is not a date that exists e.g. 31st September. 2.5 Returns service returns an error response to the Payer software; with one or more error codes. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) Page 30 IN CONFIDENCE 2.6 Payer software receives the error response code for the AIL return. 2.7 Use case ends. 3. Exception Flow – Payer is not registered for service 3.1 Payer is not registered for the ‘Returns’ service. 3.2 Identity and access services returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Payer is not Authorised to use Service 4.1 The payer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Payer software displays the error message 4.4 Payer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 31 IN CONFIDENCE Use Case 08: AIL return reassessment – retrieve return (Multi-filer) Retrieve previous AIL return (Multi-filer) IR Gateway Services Payer Payer Software Period during deductions or after deductions made 10. Process request, send AIL return payload and confirm response code 1. Request AIL return status 2. Submit AIL return status request 3. Invoke retrieveStatus operation 11. Receive previous AIL return data and response code 5. Receive all AIL returns status and original submission keys 4. Get data 6. View all AIL returns status and original submission keys 7. Retrieve AIL return is initia ted with original submission key 8. Retrieve AIL return is submitted with original submission key 9. Invoke retrieveReturn operation Start Optionally confirm return status End Page 32 IN CONFIDENCE Use Case 08 details - AIL return reassessment – retrieve return (Multi-filer) Primary actor Payer Secondary actors Payer software Returns service Description • Payer determines a return reassessment is required an amendment is required for a previously filed AIL return for a specific period • Optionally - payer retrieves AIL return status for the specified period to confirm the submission key, • Payer submits a retrieve return request to retrieve all line items from a previously file AIL return. Pre-conditions • Payer is authenticated, authorised and logged into Payer software. • Payer is enrolled for an AIL account as a multi-filer. • Payer pays investors interest on their investment accounts and deducts withholding tax on the interest. • Payer has filed a AIL return for a previous period for all investors including single and joint account holders. Post-conditions • Payer’s request is accepted and responded to. Constraints • The request must be sent using the Payer software. • As a multi-filer the payer must provide a submission key from a previously filed AIL return in order to retrieve the return. Use case scenarios 1.1 1. Normal flow Optional process to confirm the payer AIL return status 1.1 Payer initiates a status request of the AIL return for the specified period. 1.2 Payer software requests the status of the previously filed AIL return using either the period end date or the submission key allocated to that AIL return. 1.3 Returns service ‘RetrieveStatus’ operation is invoked. 1.4 Returns service responds with a response code of “0” (success), the status of the previously filed AIL return and the original submission key. 1.5 Payer software receives the response code and the original submission key for the AIL return. 1.6 Payer views the status of the requested AIL return. Process to request the previous AIL return 1.7 Payer initiates the request to retrieve a previous Payer AIL return using the original submission key. 1.8 Payer software submits a retrieve AIL return with the original submission key. 1.9 Returns service ‘retrieveReturn’ operation is invoked. 1.10 Returns service collates the AIL return data. 1.11 Returns service responds with the AIL return data payload for the specified period and response code of “0” (success). 1.12 Payer software receives the response code and the AIL return data payload. 1.13 Use case ends. Page 33 IN CONFIDENCE 2. Exception Flow – Invalid request 2.1 Payer initiates the request to retrieve a previous AIL return. 2.2 Payer software submits a retrieve AIL return for a specified period. 2.3 Returns service ‘retrieveReturn’ operation is invoked. 2.4 Returns service processes and invalidates the request due to one or more reasons including • Unrecognised XML request • XML request failed validation 2.5 Returns service returns an error response to the Payer software; with one or more error codes. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 2.6 Use case ends. 3. Exception Flow – Payer is not registered for service 3.4 Payer is not registered for the ‘Returns’ service. 3.5 Identity and Access service returns an error response to the Payer software due to • Unauthorised access • Unauthorised delegation 3.6 Use case ends. 4. Exception – Payer is not Authorised to use Service 4.1 The payer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the payer and returns an error response to the Payer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Payer software displays the error message 4.4 Payer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Payer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends.