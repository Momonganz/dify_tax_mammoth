\[IN CONFIDENCE RELEASE EXTERNAL\] Investment Income Information Portfolio Investment Entity (PIE) Gateway Services Business use cases Date: September 2020 Version: v0.2 IN REVIEW Page 2 \[IN CONFIDENCE RELEASE EXTERNAL\] Contents Investment income information – portfolio investment entity (PIE) use cases .. 3 How to use this document ................................................................................. 3 Summary of portfolio investment entity use cases ............................................... 3 Use Case 01: File a periodic PIE return (IR852) using a gateway interface ............. 4 Use Case 02: File investor certificate PIE returns (IR854) using a gateway interface7 Use Case 03: File an annual reconciliation PIE return (IR853) using a gateway interface 11 Use Case 04: Amend a periodic PIE return (IR852) using a gateway interface ...... 15 Use Case 05: Amend an annual investor certificate PIE return (IR854) using a gateway interface 19 Use Case 06: Amend an annual reconciliation PIE return (IR853) using a gateway interface 23 Use Case 07: Retrieve the status of a PIE return using a gateway interface ......... 27 Use Case 08: Retrieve a previously filed PIE return using a gateway interface ...... 30 Page 3 \[IN CONFIDENCE RELEASE EXTERNAL\] Investment income information – portfolio investment entity (PIE) use cases A selection of portfolio investment entity (PIE) use cases relevant to investment income information (III) business outcomes are provided on this document. How to use this document The portfolio investment entity business use cases show sequences of IR’s gateway Return service operations that could be used to achieve a specific business outcome. They do not comprise a comprehensive list of all required business outcomes, nor are they prescriptive or intended to inhibit software innovation in any way. Additionally the processes described to invoke the Return service operations should not inhibit innovation to combine calls across the Gateway Service to achieve the same outcome or solve business needs not described here. Summary of portfolio investment entity use cases # Business use case File Retrieve Status Retrieve Re turn 1 File a periodic PIE return (IR852) using a gateway interface 1 2 File investor certificate PIE returns (IR854) using a gateway interface 1 3 File an annual reconciliation PIE return (IR853) using a gateway interface 1 4 Amend a periodic PIE return (IR852) using a gateway interface 1 2\* 5 Amend an annual investor certificate PIE return (IR854) using a gateway interface 1 2\* 6 Amend an annual reconciliation PIE return (IR853) using a gateway interface 1 2\* 7 Retrieve the status of a PIE return using a gateway interface 1 8 Retrieve a previously filed PIE return using a gateway interface 1 2 Note - “\*” indicates optional process steps. Page 4 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 01: File a periodic PIE return (IR852) using a gateway interface File a periodic PIE return (IR852) IR Gateway Services Filer Filer Software 1. Confirm transactions for periodic PIE return (IR852) are ready to be filed 2. File a periodic PIE return (IR852) 3. Invoke File operation 4. Process PIE return, allocate submission key and confirm response code 5. Receive PIE return submission key and response code Start End Page 5 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 01 details - File a periodic PIE return (IR852) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer files an IR852 PIE return for each PIE fund. The IR852 PIE returns are filed periodically, either each month or each quarter and must be filed within one month of the end of the period. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. Post-conditions • Filer’s request is accepted and responded to. • IR processes the filed PIE return and posts the PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow At a filing pattern determined by the Filer after PIE tax deductions on PIE accounts have been made. 1.1 Filer confirms transactions for a periodic PIE return (IR852) for the period are ready to be filed. 1.2 Filer software files a periodic PIE return (IR852) for a defined period for all investor accounts that have had PIE tax deducted. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE return is processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 1.5 Filer software receives the response code and the unique submission key for the PIE return. 1.6 Use case ends. 2. Exception Flow – message fails schema or other validation 2.1 Filer confirms transactions for a periodic PIE return (IR852) for the period are ready to be filed. 2.2 Filer software files a periodic PIE return (IR852) for a defined period for all investor accounts that have had PIE tax deducted. 2.3 Returns service ‘File’ operation is invoked. 2.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September or 31st November. 2.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 2.6 Filer software receives the error response code for the PIE return. Page 6 \[IN CONFIDENCE RELEASE EXTERNAL\] 2.7 Filer reviews the error message and makes amendments to the payload format or data then confirms the PIE return is ready to be filed. Note: Even if one or more form fields are in error the complete return containing all form fields needs to be filed. 2.8 Filer software files a periodic PIE return (IR852) for a defined period for all investor accounts that have had PIE tax deducted. 2.9 Returns service ‘File’ operation is invoked. 2.10 PIE return is processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 2.11 Filer software receives the response code and a unique submission key for the PIE return. 2.12 Use case ends. 3. Exception Flow – Filer is not registered for service 3.1 Filer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Filer is not Authorised to use Service 4.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Filer software displays the error message 4.4 Filer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 7 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 02: File investor certificate PIE returns (IR854) using a gateway interface File investor certificate PIE returns (IR854) IR Gateway Services Filer Filer Software 1. Confirm transactions for investor certificate PIE returns (IR854) are ready to be filed 2. File multiple investor certificate PIE returns (IR854) \[limit of 3000 line items per return\] 3. Invoke File operation 4. Process PIE return, allocate submission key and confirm response code 5. Receive PIE return submission key and response code End Start Reoccurrng 6. Confirm all PIE returns have been filed Page 8 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 02 details - File investor certificate PIE returns (IR854) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer files IR854 PIE certificates for all investors in the PIE before filing the annual IR853 return. The IR854 PIE certificates are filed annually. The IR854 must correspond to the annual reconciliation (IR853) PIE returns. There is a limit of 3000 line items per IR854 return filed, so returns with more than 3000 line items need to be split into multiple returns (with 3000 or less line items each). Example: o IR854 PIE Return 1 has line items 1-3000 o IR854 PIE Return 2 has line items 3001-6000 and o IR854 PIE Return 3 has line items 6001-9000 Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. Post-conditions • Filer’s request is accepted and responded to. • IR processes the filed PIE return and posts the PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow At a filing pattern determined by the Filer after PIE tax deductions have been made. 1.1 Filer confirms transactions for annual investor certificate PIE returns (IR854) for the period ending 31 March are ready to be filed. 1.2 Filer software files multiple annual investor certificate PIE returns (IR854) for a defined period for all PIE accounts that have had PIE tax deducted. Note: there is a limit of 3000 line items per return. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE returns are processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 1.5 Filer software receives the response code and the unique submission key for the PIE return. This filing pattern is repeated for multiple PIE returns until all have been filed. 1.6 Filer confirms that all PIE returns have been filed. 1.7 Use case ends. 2. Exception Flow – message fails schema or other validation 2.1 Filer confirms transactions for annual investor certificate PIE returns (IR854) for the period ending 31 March are ready to be filed. 2.2 Filer software files multiple annual investor certificate PIE returns (IR854) for a defined period for all PIE accounts that have had PIE tax deducted. Note: there is a limit of 3000 line items per return. Page 9 \[IN CONFIDENCE RELEASE EXTERNAL\] 2.3 Returns service ‘File’ operation is invoked. 2.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September, 31st November. 2.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 2.6 Filer software receives the error response code for the PIE return. 2.7 Filer reviews the error message and makes amendments to the payload format or data then confirms the PIE return is ready to be filed. Note: Even if one or more line items are in error the complete return containing all line items needs to be filed. 2.8 Filer software files multiple annual investor certificate PIE returns (IR854) for a defined period for all PIE accounts that have had PIE tax deducted. Note: there is a limit of 3000 line items per return. 2.9 Returns service ‘File’ operation is invoked. 2.10 PIE returns are processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 2.11 Filer software receives the response code and a unique submission key for the PIE return. 2.12 Use case ends. 3. Exception Flow – Filer is not registered for service 3.1 Filer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Filer is not Authorised to use Service 4.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Filer software displays the error message 4.4 Filer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. Page 10 \[IN CONFIDENCE RELEASE EXTERNAL\] 5.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 11 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 03: File an annual reconciliation PIE return (IR853) using a gateway interface File an annual reconciliation PIE return (IR853) IR Gateway Services Filer Filer Software 1. Confirm transactions for annual reconciliation PIE return (IR853) are ready to be filed 2. File an annual reconciliation PIE return (IR853) 3. Invoke File operation 4. Process PIE return, allocate submission key and confirm response code 5. Receive PIE return submission key and response code Start End Page 12 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 03 details - File an annual reconciliation PIE return (IR853) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer files an IR853 PIE return for each PIE fund. An Annual reconciliation return (IR853) providing the details for all investors in the Multi Rate Pie (MRP) needs to be filed electronically. Investor certificates (IR854) for each investor are required to be sent to us before the reconciliation. There will be no assessment issued or payments required for the annual reconciliation. The IR853 PIE returns are filed annually. The IR853 PIE return reconciles the periodic (IR852) PIE returns. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. • Filer must have filed the PIE investor certificates (IR854) for all investors. Post-conditions • Filer’s request is accepted and responded to. • IR processes the filed PIE return and posts the PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow At a filing pattern determined by the Filer after PIE tax deductions have been made. 1.1 Filer confirms transactions for an annual reconciliation PIE return (IR853) for the period ending 31 March are ready to be filed. 1.2 Filer software files an annual reconciliation PIE return (IR853) for a defined period for all investor accounts that have had PIE tax deducted. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE return is processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 1.5 Filer software receives the response code and the unique submission key for the PIE return. 1.6 Use case ends. 2. Exception Flow – message fails schema or other validation 2.1 Filer confirms transactions for an annual reconciliation PIE return (IR853) for the period ending 31 March are ready to be filed. 2.2 Filer software files an annual reconciliation PIE return (IR853) for a defined period for all investor accounts that have had PIE tax deducted. 2.3 Returns service ‘File’ operation is invoked. 2.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request Page 13 \[IN CONFIDENCE RELEASE EXTERNAL\] • XML request failed validation • data invalidations e.g. period end date is not a date that exists e.g. 31st September or 31st November. 2.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 2.6 Filer software receives the error response code for the PIE return. 2.7 Filer reviews the error message and makes amendments to the payload format or data then confirms the PIE return is ready to be filed. Note: Even if one or more form fields are in error the complete return containing all form fields needs to be filed. 2.8 Filer software files an annual reconciliation PIE return (IR853) for a defined period for all investor accounts that have had PIE tax deducted. 2.9 Returns service ‘File’ operation is invoked. 2.10 PIE return is processed and allocated a submission key. A response is returned with a response code of “0” (success) and the unique submission key. 2.11 Filer software receives the response code and a unique submission key for the PIE return. 2.12 Use case ends. 3. Exception Flow – Filer is not registered for service 3.1 Filer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Filer software due to a. Unauthorised access b. Unauthorised delegation 3.3 Use case ends. 4. Exception – Filer is not Authorised to use Service 4.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to a. Unauthorised delegation b. Unauthorised vendor c. Account type not supported 4.3 Filer software displays the error message 4.4 Filer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. Page 14 \[IN CONFIDENCE RELEASE EXTERNAL\] 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 15 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 04: Amend a periodic PIE return (IR852) using a gateway interface Amend a periodic PIE return (IR852) IR Gateway Services Filer Filer Software Period during deductions or after deductions made 4. Process PIE return, provide original submission key and confirm response code 5. Receive PIE return submission key and response code 1. Confirm amended form fields for periodic PIE return (IR852) are ready to be filed 2. File amended periodic PIE return (IR852) with original submission key for amended form fields 3. Invoke File operation Start End Page 16 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 04 details - Amend a periodic PIE return (IR852) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer determines an amendment is required to one or more form fields in a previously filed periodic PIE return (IR852) for a defined period. Filer files an amended periodic PIE return (IR852) for the same period which includes only the updated form fields. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. • Filer has previously filed a periodic PIE return (IR852). Post-conditions • Filer’s request is accepted and responded to. • IR processes the amended PIE return and posts the updated PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow Amendment is ready to be filed for PIE returns 1.1 Filer confirms the amended form fields for a periodic PIE return (IR852) are ready to be filed. 1.2 Filer software files amended periodic PIE return (IR852) for a defined period with the updated form fields and original submission key. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE return is processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 1.5 Filer software receives the response code and the original return submission key for the amended PIE return. 1.6 Use case ends. 2. Exception Flow – Submission Key unknown for the PIE return To confirm submission key of a filed PIE return 2.1 Filer initiates a single status request of all filed PIE returns for the defined period. 2.2 Filer software requests the return status the previously filed PIE returns using the Filer name and period end date. 2.3 Returns service ‘RetrieveStatus’ operation is invoked. 2.4 Returns service responds with a response code of “0” (success), the status of all previously filed PIE returns and their submission keys. Amendment is ready to be filed for a PIE return 2.5 Filer confirms the amended form fields for a periodic PIE return (IR852) are ready to be filed. 2.6 Filer software files amended periodic PIE return (IR852) for a defined period with the updated form fields and original submission key. Page 17 \[IN CONFIDENCE RELEASE EXTERNAL\] 2.7 Returns service ‘File’ operation is invoked. 2.8 PIE return is processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 2.9 Filer software receives the response code and the original return submission key for the amended PIE return. 2.10 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Filer confirms the amended form fields for a periodic PIE return (IR852) are ready to be filed. 3.2 Filer software files amended periodic PIE return (IR852) for a defined period with the updated form fields and original submission key. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations 3.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 3.6 Use case ends. 4. Exception Flow – Filer is not registered for service 4.1 Filer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Filer is not Authorised to use Service 5.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 5.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Filer software displays the error message 5.4 Filer views the error message 5.5 Use case ends. 6. Exception – Authentication token is expired 6.1 Identity and access services validate and find authentication token expired 6.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack) Page 18 \[IN CONFIDENCE RELEASE EXTERNAL\] 6.3 Identity and access services validate credentials and generate new token. 6.4 Identity and access services records new token generation request 6.5 Use case ends. Page 19 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 05: Amend an annual investor certificate PIE return (IR854) using a gateway interface Amend annual investor certificate PIE returns (IR854) IR Gateway Services Filer Filer Software 1. Confirm amended line items for annual investor certificate PIE returns (IR854) are ready to be filed 2. File multiple amended annual investor certificate PIE returns (IR854) with original submission key for amended line items \[limit of 3000 line items per return\] 3. Invoke File operation 4. Process PIE returns, provide original submission key and confirm response code 5. Receive PIE return submission key and response code End Start Reoccurrng 6. Confirm all PIE returns have been filed Page 20 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 05 details - Amend an annual investor certificate PIE return (IR854) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer determines an amendment is required to one or more line items in previously filed annual investor certificate PIE returns (IR854) for a defined period. • Filer files amended annual investor certificate PIE returns (IR854) for the same period which includes only the updated line items. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. • Filer has previously filed an annual investor certificate PIE return (IR854). Post-conditions • Filer’s request is accepted and responded to. • IR processes the amended PIE return and posts the updated PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow Amendment is ready to be filed for PIE returns 1.1 Filer confirms the amended line items for multiple annual investor certificate PIE returns (IR854) are ready to be filed. 1.2 Filer software files amended line items for multiple annual investor certificate PIE returns (IR854) for a defined period with the updated line items and original submission key. Note: there is a limit of 3000 line items per return. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE returns are processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 1.5 Filer software receives the response code and the original return submission key for the amended PIE return. 1.6 Use case ends. 2. Exception Flow – Submission Key unknown for the PIE return To confirm submission key of a filed PIE return 2.1 Filer initiates a single status request of all filed PIE returns for the defined period. 2.2 Filer software requests the return status the previously filed PIE returns using the Filer name and period end date. 2.3 Returns service ‘RetrieveStatus’ operation is invoked. 2.4 Returns service responds with a response code of “0” (success), the status of all previously filed PIE returns and their submission keys. Amendment is ready to be filed for a PIE return 2.5 Filer confirms the amended line items for multiple annual investor certificate PIE returns (IR854) are ready to be filed. Page 21 \[IN CONFIDENCE RELEASE EXTERNAL\] 2.6 Filer software files amended line items for multiple annual investor certificate PIE returns (IR854) for a defined period with the updated line items and original submission key. Note: there is a limit of 3000 line items per return. 2.7 Returns service ‘File’ operation is invoked. 2.8 PIE returns are processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 2.9 Filer software receives the response code and the original return submission key for the amended PIE return. 2.10 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Filer confirms the amended line items for multiple annual investor certificate PIE returns (IR854) are ready to be filed. 3.2 Filer software files amended line items for multiple annual investor certificate PIE returns (IR854) for a defined period with the updated line items and original submission key. Note: there is a limit of 3000 line items per return. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations 3.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 3.6 Use case ends. 4. Exception Flow – Filer is not registered for service 4.1 Filer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Filer is not Authorised to use Service 5.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 5.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Filer software displays the error message 5.4 Filer views the error message 5.5 Use case ends. Page 22 \[IN CONFIDENCE RELEASE EXTERNAL\] 6. Exception – Authentication token is expired 6.1 Identity and access services validate and find authentication token expired 6.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack) 6.3 Identity and access services validate credentials and generate new token. 6.4 Identity and access services records new token generation request 6.5 Use case ends. Page 23 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 06: Amend an annual reconciliation PIE return (IR853) using a gateway interface Amend an annual reconciliation PIE return (IR853) IR Gateway Services Filer Filer Software Period during deductions or after deductions made 4. Process PIE return, provide original submission key and confirm response code 5. Receive PIE return submission key and response code 1. Confirm amended form fields for annual reconciliation PIE return (IR853) are ready to be filed 2. File amended annual reconciliation PIE return (IR853) with original submission key for amended form fields 3. Invoke File operation Start End Page 24 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 06 details - Amend an annual reconciliation PIE return (IR853) using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer determines an amendment is required to one or more form fields in a previously filed annual reconciliation PIE return (IR853) for a defined period. • Filer files an amended annual reconciliation PIE return (IR853) for the same period which includes only the updated form fields. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has a logon for myIR that has access to the PIE account. • Filer has previously filed an annual reconciliation PIE return (IR853). Post-conditions • Filer’s request is accepted and responded to. • IR processes the amended PIE return and posts the updated PIE tax assessment on their PIE account. • PIE returns are processed overnight. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow Amendment is ready to be filed for PIE returns 1.1 Filer confirms the amended form fields for an annual reconciliation PIE return (IR853) are ready to be filed. 1.2 Filer software files amended form fields for an annual reconciliation PIE return (IR853) for a defined period with the updated form fields and original submission key. 1.3 Returns service ‘File’ operation is invoked. 1.4 PIE return is processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 1.5 Filer software receives the response code and the original return submission key for the amended PIE return. 1.6 Use case ends. 2. Exception Flow – Submission Key unknown for the PIE return To confirm submission key of a filed PIE return 2.1 Filer initiates a single status request of all filed PIE returns for the defined period. 2.2 Filer software requests the return status the previously filed PIE returns using the Filer name and period end date. 2.3 Returns service ‘RetrieveStatus’ operation is invoked. 2.4 Returns service responds with a response code of “0” (success), the status of all previously filed PIE returns and their submission keys. Amendment is ready to be filed for a PIE return 2.5 Filer confirms the amended form fields for an annual reconciliation PIE return (IR853) are ready to be filed. Page 25 \[IN CONFIDENCE RELEASE EXTERNAL\] 2.6 Filer software files amended form fields for an annual reconciliation PIE return (IR853) for a defined period with the updated form fields and original submission key. 2.7 Returns service ‘File’ operation is invoked. 2.8 PIE return is processed with original submission key. A response is returned with a response code of “0” (success) and the original submission key. 2.9 Filer software receives the response code and the original return submission key for the amended PIE return. 2.10 Use case ends. 3. Exception Flow – message fails schema or other validation 3.1 Filer confirms the amended form fields for an annual reconciliation PIE return (IR853) are ready to be filed. 3.2 Filer software files amended form fields for an annual reconciliation PIE return (IR853) for a defined period with the updated form fields and original submission key. 3.3 Returns service ‘File’ operation is invoked. 3.4 Returns service processes and invalidates the PIE return payload data due to one or more reasons including • Unrecognised XML request • XML request failed validation • data invalidations 3.5 Returns service returns an error response to the Filer software; with one or more error codes, up to a maximum of 200 (please see section 5.1 and 5.2 for the response codes in Returns service build pack - III). An error results in the entire return being rejected. 3.6 Use case ends. 4. Exception Flow – Filer is not registered for service 4.1 Filer is not registered for the ‘Returns’ service. 4.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 4.3 Use case ends. 5. Exception – Filer is not Authorised to use Service 5.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 5.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 5.3 Filer software displays the error message 5.4 Filer views the error message 5.5 Use case ends. 6. Exception – Authentication token is expired 6.1 Identity and access services validate and find authentication token expired Page 26 \[IN CONFIDENCE RELEASE EXTERNAL\] 6.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack) 6.3 Identity and access services validate credentials and generate new token. 6.4 Identity and access services records new token generation request 6.5 Use case ends. Page 27 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 07: Retrieve the status of a PIE return using a gateway interface Retrieve status of previously filed PIE return IR Gateway Services Filer Filer Software Period during deductions or after deductions made 1. Request PIE return status 2. Submit PIE return status request 3. Invoke retrieveStatus operation 5. Receive all PIE returns status and original submission keys 4. Get data 6. View all PIE return status and original submission keys Start End Page 28 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 07 details - Retrieve the status of a PIE return using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer retrieves PIE return status for the defined period to confirm the submission key, • Filer retrieves PIE return status for the defined period to confirm the status of the return. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has previously filed a PIE return. Post-conditions • Filer’s request is accepted and responded to. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow Process to request status of a previous PIE return. 1.1 Filer initiates a status request of the PIE return for the defined period. 1.2 Filer software requests the status of the previously filed PIE return using either the period end date or the submission key allocated to that PIE return. 1.3 Returns service ‘retrieveStatus’ operation is invoked. 1.4 Returns service responds with a response code of “0” (success), the status of the previously filed PIE return and the original submission key. 1.5 Filer software receives the response code and the original submission key for the PIE return. 1.6 Filer views the status of the requested PIE return. 1.7 Use case ends. 2. Exception Flow – Invalid request 2.1 Filer initiates a status request of a previous Filer PIE return. 2.2 Filer software requests the status of the previously filed PIE return using either the period end date or the submission key allocated to that PIE return. 2.3 Returns service ‘retrieveStatus’ operation is invoked. 2.4 Returns service processes and invalidates the request due to one or more reasons including • Unrecognised XML request • XML request failed validation 2.5 Returns service returns an error response to the Filer software; with one or more error codes. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 2.6 Use case ends. 3. Exception Flow – Filer is not registered for service 3.1 Filer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Filer software due to Page 29 \[IN CONFIDENCE RELEASE EXTERNAL\] • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Filer is not Authorised to use Service 4.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Filer software displays the error message 4.4 Filer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends. Page 30 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 08: Retrieve a previously filed PIE return using a gateway interface Retrieve a previously filed PIE return IR Gateway Services Filer Filer Software Period during deductions or after deductions made 10. Process request, send PIE return payload and confirm response code 1. Request PIE return status 2. Submit PIE return status request 3. Invoke retrieveStatus operation 11. Receive previous PIE return data and response code 5. Receive all PIE returns status and original submission keys 4. Get data 6. View all PIE return status and original submission keys 7. Retrieve PIE return is initiated with original submission key 8. Retrieve PIE return is submitted with original submission key 9. Invoke retrieveReturn operation Start End Page 31 \[IN CONFIDENCE RELEASE EXTERNAL\] Use Case 08 details - Retrieve a previously filed PIE return using a gateway interface Primary actor Filer Secondary actors Filer software Returns service Description • Filer determines an amendment is required for a previously filed PIE return for a defined period, • Filer retrieves PIE return status for the defined period to confirm the submission key, • Filer submits a retrieve return request to retrieve all form fields or line items from a previously file PIE return. Pre-conditions • Filer is authenticated, authorised and logged into Filer software. • Filer has previously filed a PIE return. Post-conditions • Filer’s request is accepted and responded to. Constraints • The request must be sent using the Filer software. Use case scenarios 1. Normal flow Process to request the status of a previous PIE return and retrieve the original submission key. 1.1 Filer initiates a status request of the PIE return for the defined period. 1.2 Filer software requests the status of the previously filed PIE return using either the period end date or the submission key allocated to that PIE return. 1.3 Returns service ‘retrieveStatus’ operation is invoked. 1.4 Returns service responds with a response code of “0” (success), the status of the previously filed PIE return and the original submission key. 1.5 Filer software receives the response code and the original submission key for the PIE return. 1.6 Filer views the status of the requested PIE return. Process to request the previous PIE return. 1.7 Filer initiates the request to retrieve a previous Filer PIE return using the original submission key. 1.8 Filer software submits a retrieve PIE return with the original submission key. 1.9 Returns service ‘retrieveReturn’ operation is invoked. 1.10 Returns service collates the PIE return data. 1.11 Returns service responds with the PIE return data payload for the defined period and response code of “0” (success). 1.12 Filer software receives the response code and the PIE return data payload. 1.13 Use case ends. 2. Exception Flow – Invalid request 2.1 Filer initiates the request to retrieve a previous Filer PIE return. 2.2 Filer software submits a retrieve PIE return for a defined period. 2.3 Returns service ‘retrieveReturn’ operation is invoked. 2.4 Returns service processes and invalidates the request due to one or more reasons including Page 32 \[IN CONFIDENCE RELEASE EXTERNAL\] • Unrecognised XML request • XML request failed validation 2.5 Returns service returns an error response to the Filer software; with one or more error codes. (Please see section 5.1 and 5.2 for the response codes in Returns service build pack - III) 2.6 Use case ends. 3. Exception Flow – Filer is not registered for service 3.1 Filer is not registered for the ‘Returns’ service. 3.2 Identity and Access service returns an error response to the Filer software due to • Unauthorised access • Unauthorised delegation 3.3 Use case ends. 4. Exception – Filer is not Authorised to use Service 4.1 The Filer is valid, however doesn’t have the correct permissions to use this service. 4.2 Returns service fails to authorise the Filer and returns an error response to the Filer software (please refer section 5 ‘Response codes’ in the Returns service build pack - III) due to • Unauthorised delegation • Unauthorised vendor • Account type not supported 4.3 Filer software displays the error message 4.4 Filer views the error message 4.5 Use case ends. 5. Exception – Authentication token is expired 5.1 Identity and access services validates and finds the authentication token has expired. 5.2 Identity and access services returns an error response to the Filer software for the authentication failure (please refer section 2 in the Identity and Access Services build pack). 5.3 Identity and access services validate credentials and generates a new token. 5.4 Identity and access services records a new token generation request. 5.5 Use case ends.